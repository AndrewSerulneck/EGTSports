<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marc's Parlays - NFL Betting</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Lock, Unlock, Save, RefreshCw } = lucide;

        function App() {
            const [isAdmin, setIsAdmin] = useState(false);
            const [showAdminLogin, setShowAdminLogin] = useState(false);
            const [adminPassword, setAdminPassword] = useState('');
            const [games, setGames] = useState([]);
            const [loading, setLoading] = useState(true);
            const [selectedPicks, setSelectedPicks] = useState({});
            const [showConfirmation, setShowConfirmation] = useState(false);
            const [ticketNumber, setTicketNumber] = useState('');
            const [showCheckout, setShowCheckout] = useState(false);
            const [contactInfo, setContactInfo] = useState({ name: '', email: '', phone: '' });
            const [showPayment, setShowPayment] = useState(false);

            const ADMIN_PASSWORD = 'MeMarc25';
            const VENMO_USERNAME = 'Marc-Serulneck';

            useEffect(() => { loadGames(); }, []);

            const loadGames = async () => {
                setLoading(true);
                try {
                    const stored = localStorage.getItem('marcs-parlays-games');
                    if (stored) {
                        setGames(JSON.parse(stored));
                        setLoading(false);
                        return;
                    }

                    const response = await fetch('https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard');
                    const data = await response.json();
                    
                    const formattedGames = data.events.map((event, index) => ({
                        id: index + 1,
                        espnId: event.id,
                        date: new Date(event.date).toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }),
                        time: new Date(event.date).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }) + ' ET',
                        awayTeam: event.competitions[0].competitors[1].team.displayName,
                        homeTeam: event.competitions[0].competitors[0].team.displayName,
                        awaySpread: '',
                        homeSpread: ''
                    }));

                    setGames(formattedGames);
                } catch (error) {
                    console.error('Error loading games:', error);
                }
                setLoading(false);
            };

            const saveGames = () => {
                localStorage.setItem('marcs-parlays-games', JSON.stringify(games));
                alert('Games and odds saved!');
            };

            const updateSpread = (gameId, team, value) => {
                setGames(games.map(game => 
                    game.id === gameId 
                        ? { ...game, [team === 'away' ? 'awaySpread' : 'homeSpread']: value }
                        : game
                ));
            };

            const toggleTeam = (gameId, teamType) => {
                setSelectedPicks(prev => {
                    const newPicks = { ...prev };
                    if (newPicks[gameId] === teamType) {
                        delete newPicks[gameId];
                    } else {
                        newPicks[gameId] = teamType;
                    }
                    return newPicks;
                });
            };

            const generateTicketNumber = () => {
                const timestamp = Date.now().toString(36).toUpperCase();
                const random = Math.random().toString(36).substring(2, 8).toUpperCase();
                return `TKT-${timestamp}-${random}`;
            };

            const submitPicks = () => {
                if (Object.keys(selectedPicks).length === 0) {
                    alert('Please select at least one pick!');
                    return;
                }
                setTicketNumber(generateTicketNumber());
                setShowConfirmation(true);
            };

            const handleCheckoutSubmit = () => {
                if (!contactInfo.name || !contactInfo.email || !contactInfo.phone) {
                    alert('Please fill in all contact information');
                    return;
                }
                
                const submission = {
                    ticketNumber,
                    timestamp: new Date().toISOString(),
                    contactInfo,
                    picks: Object.entries(selectedPicks).map(([gameId, teamType]) => {
                        const game = games.find(g => g.id == gameId);
                        return {
                            team: teamType === 'away' ? game.awayTeam : game.homeTeam,
                            spread: teamType === 'away' ? game.awaySpread : game.homeSpread
                        };
                    })
                };

                console.log('NEW SUBMISSION:', JSON.stringify(submission, null, 2));
                setShowPayment(true);
            };

            if (loading) {
                return (
                    <div className="gradient-bg" style={{display: 'flex', alignItems: 'center', justifyContent: 'center', minHeight: '100vh'}}>
                        <div style={{color: 'white', fontSize: '24px'}}>Loading games from ESPN...</div>
                    </div>
                );
            }

            if (isAdmin) {
                return (
                    <div className="gradient-bg" style={{padding: '20px'}}>
                        <div style={{maxWidth: '1000px', margin: '0 auto'}}>
                            <div style={{background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '24px'}}>
                                <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '16px'}}>
                                    <h1>🔧 Admin Panel</h1>
                                    <button onClick={() => setIsAdmin(false)} style={{padding: '8px 16px', background: '#6c757d', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Exit Admin</button>
                                </div>
                                <button onClick={loadGames} style={{padding: '8px 16px', background: '#007bff', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Refresh from ESPN</button>
                            </div>

                            {games.map(game => (
                                <div key={game.id} style={{background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '16px'}}>
                                    <div style={{marginBottom: '16px', color: '#666'}}>{game.date} - {game.time}</div>
                                    <div style={{marginBottom: '12px'}}>
                                        <label style={{display: 'block', fontWeight: '600', marginBottom: '4px'}}>{game.awayTeam} (Away)</label>
                                        <input type="text" value={game.awaySpread} onChange={(e) => updateSpread(game.id, 'away', e.target.value)} placeholder="+3.5" style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px'}} />
                                    </div>
                                    <div>
                                        <label style={{display: 'block', fontWeight: '600', marginBottom: '4px'}}>{game.homeTeam} (Home)</label>
                                        <input type="text" value={game.homeSpread} onChange={(e) => updateSpread(game.id, 'home', e.target.value)} placeholder="-3.5" style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px'}} />
                                    </div>
                                </div>
                            ))}

                            <div style={{background: 'white', borderRadius: '12px', padding: '24px'}}>
                                <button onClick={saveGames} style={{width: '100%', padding: '16px', background: '#28a745', color: 'white', fontSize: '18px', fontWeight: '600', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Save All Games & Odds</button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (showAdminLogin) {
                return (
                    <div className="gradient-bg" style={{padding: '20px', minHeight: '100vh'}}>
                        <div style={{maxWidth: '400px', margin: '80px auto'}}>
                            <div style={{background: 'white', borderRadius: '12px', padding: '32px'}}>
                                <h2 style={{textAlign: 'center', marginBottom: '24px'}}>Admin Login</h2>
                                <input type="password" value={adminPassword} onChange={(e) => setAdminPassword(e.target.value)} placeholder="Enter password" style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px', marginBottom: '16px'}} />
                                <button onClick={() => adminPassword === ADMIN_PASSWORD ? setIsAdmin(true) : alert('Incorrect password')} style={{width: '100%', padding: '12px', background: '#007bff', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer', marginBottom: '12px'}}>Login</button>
                                <button onClick={() => setShowAdminLogin(false)} style={{width: '100%', padding: '12px', background: '#6c757d', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Back</button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (showCheckout) {
                return (
                    <div className="gradient-bg" style={{padding: '20px', minHeight: '100vh'}}>
                        <div style={{maxWidth: '600px', margin: '0 auto'}}>
                            <div style={{textAlign: 'center', color: 'white', marginBottom: '32px'}}>
                                <h1>💳 Checkout</h1>
                            </div>
                            <button onClick={() => setShowCheckout(false)} style={{marginBottom: '16px', padding: '8px 16px', background: '#6c757d', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>← Back</button>
                            
                            <div style={{background: 'white', borderRadius: '12px', padding: '32px'}}>
                                <div style={{background: '#f8f9fa', padding: '16px', borderRadius: '8px', textAlign: 'center', marginBottom: '24px'}}>
                                    <div style={{fontSize: '12px', color: '#666', marginBottom: '8px'}}>TICKET NUMBER</div>
                                    <div style={{fontSize: '24px', fontWeight: 'bold', color: '#28a745'}}>{ticketNumber}</div>
                                </div>

                                <h3 style={{marginBottom: '16px'}}>Your Picks</h3>
                                {Object.entries(selectedPicks).map(([gameId, teamType]) => {
                                    const game = games.find(g => g.id == gameId);
                                    const team = teamType === 'away' ? game.awayTeam : game.homeTeam;
                                    const spread = teamType === 'away' ? game.awaySpread : game.homeSpread;
                                    return (
                                        <div key={gameId} style={{display: 'flex', justifyContent: 'space-between', padding: '12px', background: '#f8f9fa', borderRadius: '8px', marginBottom: '8px'}}>
                                            <span style={{fontWeight: '600'}}>{team}</span>
                                            <span>{spread}</span>
                                        </div>
                                    );
                                })}

                                <h3 style={{marginTop: '24px', marginBottom: '16px'}}>Contact Information</h3>
                                <div style={{marginBottom: '16px'}}>
                                    <label style={{display: 'block', fontWeight: '600', marginBottom: '8px'}}>Full Name *</label>
                                    <input type="text" value={contactInfo.name} onChange={(e) => setContactInfo({...contactInfo, name: e.target.value})} style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px'}} />
                                </div>
                                <div style={{marginBottom: '16px'}}>
                                    <label style={{display: 'block', fontWeight: '600', marginBottom: '8px'}}>Email *</label>
                                    <input type="email" value={contactInfo.email} onChange={(e) => setContactInfo({...contactInfo, email: e.target.value})} style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px'}} />
                                </div>
                                <div style={{marginBottom: '16px'}}>
                                    <label style={{display: 'block', fontWeight: '600', marginBottom: '8px'}}>Phone *</label>
                                    <input type="tel" value={contactInfo.phone} onChange={(e) => setContactInfo({...contactInfo, phone: e.target.value})} placeholder="(555) 123-4567" style={{width: '100%', padding: '12px', border: '2px solid #e0e0e0', borderRadius: '8px'}} />
                                </div>

                                <button onClick={handleCheckoutSubmit} style={{width: '100%', padding: '16px', background: '#28a745', color: 'white', fontSize: '18px', fontWeight: '600', border: 'none', borderRadius: '8px', cursor: 'pointer', marginTop: '24px'}}>Continue to Payment →</button>

                                {showPayment && (
                                    <div style={{marginTop: '32px', paddingTop: '32px', borderTop: '2px solid #e0e0e0'}}>
                                        <h3 style={{textAlign: 'center', marginBottom: '16px'}}>💰 Payment</h3>
                                        <div style={{background: '#f8f9fa', padding: '16px', borderRadius: '8px', textAlign: 'center', marginBottom: '16px'}}>
                                            <p>Venmo your wager to @{VENMO_USERNAME}</p>
                                        </div>
                                        <a href={`venmo://paycharge?txn=pay&recipients=${VENMO_USERNAME}&note=${encodeURIComponent('Marcs Parlays - ' + ticketNumber)}`} style={{display: 'block', padding: '16px', background: '#008CFF', color: 'white', textAlign: 'center', textDecoration: 'none', borderRadius: '8px', fontWeight: '600'}}>Pay with Venmo</a>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="gradient-bg" style={{padding: '20px'}}>
                    <div style={{maxWidth: '1000px', margin: '0 auto'}}>
                        <div style={{textAlign: 'center', color: 'white', marginBottom: '32px'}}>
                            <h1 style={{fontSize: '36px', marginBottom: '8px'}}>🏈 Marc's Parlays</h1>
                            <p style={{fontSize: '20px'}}>NFL Betting Pool</p>
                            <button onClick={() => setShowAdminLogin(true)} style={{marginTop: '16px', padding: '8px 16px', background: 'rgba(0,0,0,0.3)', color: 'white', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Admin Login</button>
                        </div>

                        <div style={{background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '32px'}}>
                            <h2 style={{textAlign: 'center', marginBottom: '16px'}}>💰 Payout Odds</h2>
                            <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '12px'}}>
                                {[
                                    {picks: 3, payout: '2 to 1'}, {picks: 4, payout: '3 to 1'},
                                    {picks: 5, payout: '4 to 1'}, {picks: 6, payout: '5 to 1'},
                                    {picks: 7, payout: '6 to 1'}, {picks: 8, payout: '7 to 1'},
                                    {picks: 9, payout: '8 to 1'}, {picks: 10, payout: '10 to 1'}
                                ].map(item => (
                                    <div key={item.picks} style={{background: '#f8f9fa', padding: '12px', borderRadius: '8px', textAlign: 'center', border: '2px solid #e0e0e0'}}>
                                        <div style={{fontSize: '14px'}}>{item.picks} for {item.picks} pays</div>
                                        <div style={{fontSize: '18px', fontWeight: 'bold', color: '#28a745'}}>{item.payout}</div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {games.map(game => (
                            <div key={game.id} style={{background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '16px'}}>
                                <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '16px', paddingBottom: '12px', borderBottom: '2px solid #f0f0f0'}}>
                                    <span style={{color: '#666'}}>{game.date}</span>
                                    <span style={{color: '#666', fontWeight: '600'}}>{game.time}</span>
                                </div>
                                
                                <div onClick={() => toggleTeam(game.id, 'away')} style={{display: 'flex', justifyContent: 'space-between', padding: '16px', borderRadius: '8px', cursor: 'pointer', marginBottom: '12px', background: selectedPicks[game.id] === 'away' ? '#d4edda' : '#f8f9fa', border: selectedPicks[game.id] === 'away' ? '2px solid #28a745' : 'none'}}>
                                    <div style={{display: 'flex', alignItems: 'center', gap: '12px'}}>
                                        <input type="checkbox" checked={selectedPicks[game.id] === 'away'} onChange={() => {}} />
                                        <span style={{fontWeight: '600'}}>{game.awayTeam}</span>
                                        <span style={{fontSize: '12px', background: '#e9ecef', padding: '2px 8px', borderRadius: '4px'}}>AWAY</span>
                                    </div>
                                    <span style={{fontWeight: '600'}}>{game.awaySpread}</span>
                                </div>

                                <div style={{textAlign: 'center', color: '#999', margin: '8px 0'}}>@</div>

                                <div onClick={() => toggleTeam(game.id, 'home')} style={{display: 'flex', justifyContent: 'space-between', padding: '16px', borderRadius: '8px', cursor: 'pointer', background: selectedPicks[game.id] === 'home' ? '#d4edda' : '#f8f9fa', border: selectedPicks[game.id] === 'home' ? '2px solid #28a745' : 'none'}}>
                                    <div style={{display: 'flex', alignItems: 'center', gap: '12px'}}>
                                        <input type="checkbox" checked={selectedPicks[game.id] === 'home'} onChange={() => {}} />
                                        <span style={{fontWeight: '600'}}>{game.homeTeam}</span>
                                        <span style={{fontSize: '12px', background: '#e9ecef', padding: '2px 8px', borderRadius: '4px'}}>HOME</span>
                                    </div>
                                    <span style={{fontWeight: '600'}}>{game.homeSpread}</span>
                                </div>
                            </div>
                        ))}

                        <div style={{textAlign: 'center', marginBottom: '32px'}}>
                            <div style={{color: 'white', fontSize: '20px', marginBottom: '16px'}}>
                                Selected: {Object.keys(selectedPicks).length} picks
                            </div>
                            <button onClick={submitPicks} disabled={Object.keys(selectedPicks).length === 0} style={{padding: '16px 48px', background: Object.keys(selectedPicks).length === 0 ? '#6c757d' : '#28a745', color: 'white', fontSize: '20px', fontWeight: 'bold', border: 'none', borderRadius: '8px', cursor: Object.keys(selectedPicks).length === 0 ? 'not-allowed' : 'pointer'}}>Submit Picks</button>
                        </div>

                        <div style={{background: 'white', borderRadius: '12px', padding: '32px'}}>
                            <h3 style={{marginBottom: '16px'}}>📋 Rules</h3>
                            <ul style={{marginLeft: '20px', lineHeight: '1.8'}}>
                                <li>Missing info = voided ticket</li>
                                <li>Must pay in advance via Venmo to @{VENMO_USERNAME}</li>
                                <li>Winners paid following Tuesday</li>
                                <li>Minimum 3 picks required</li>
                            </ul>
                            <div style={{background: '#fff3cd', border: '2px solid #ffc107', borderRadius: '8px', padding: '16px', marginTop: '20px'}}>
                                <strong>⚠️ Legal Disclaimer</strong><br/>
                                For entertainment only. 21+ only. Private pool among friends. Check local laws.
                            </div>
                        </div>
                    </div>

                    {showConfirmation && (
                        <div style={{position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', background: 'rgba(0,0,0,0.7)', display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '20px'}}>
                            <div style={{background: 'white', borderRadius: '12px', padding: '32px', maxWidth: '500px', width: '100%'}}>
                                <h2 style={{fontSize: '30px', color: '#28a745', textAlign: 'center', marginBottom: '16px'}}>✅ Picks Submitted!</h2>
                                <div style={{background: '#f8f9fa', padding: '16px', borderRadius: '8px', textAlign: 'center', marginBottom: '24px'}}>
                                    <div style={{fontSize: '24px', fontWeight: 'bold'}}>{ticketNumber}</div>
                                </div>
                                <button onClick={() => { setShowConfirmation(false); setShowCheckout(true); }} style={{width: '100%', padding: '12px', background: '#007bff', color: 'white', fontWeight: '600', border: 'none', borderRadius: '8px', cursor: 'pointer'}}>Continue to Checkout</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
